(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{O9UJ:function(t,e,n){"use strict";n.r(e);var r=n("KHd+"),a=n("UQSp"),s=n("Kw5r");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}s.a.config.optionMergeStrategies;var i={VueRemarkRoot:a.a},p=function(t){var e=t.options.components=t.options.components||{},n=t.options.computed=t.options.computed||{};Object.keys(i).forEach((function(t){"object"===o(i[t])&&"function"==typeof i[t].render||"function"==typeof i[t]&&"function"==typeof i[t].options.render?e[t]=i[t]:n[t]=function(){return i[t]}}))},l=s.a.config.optionMergeStrategies,c="__vueRemarkFrontMatter",u={excerpt:null,title:"Getting started",topic:"intro",type:"how-to",roles:["THIRD_PARTY_DEVELOPER"]};var v=function(t){t.options[c]&&(t.options[c]=u),s.a.util.defineReactive(t.options,c,u),t.options.computed=l.computed({$frontmatter:function(){return t.options[c]}},t.options.computed)},d=Object(r.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("VueRemarkRoot",[n("h1",{attrs:{id:"getting-started"}},[n("a",{attrs:{href:"#getting-started","aria-hidden":"true"}},[t._v("#")]),t._v("Getting started")]),n("p",[n("strong",[t._v("This guide will show you how to start using our APIs with a hands on tutorial for listening to events.")])]),n("h2",{attrs:{id:"download-proto-descriptions"}},[n("a",{attrs:{href:"#download-proto-descriptions","aria-hidden":"true"}},[t._v("#")]),t._v("Download proto descriptions")]),n("p",[t._v("You can find our "),n("code",{pre:!0},[t._v(".proto")]),t._v(" files at "),n("a",{attrs:{href:"https://github.com/working-group-two/wgtwoapis",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("https://github.com/working-group-two/wgtwoapis")])]),n("p",[t._v("Download the FileDescriptorSet for our APIs, which contains all our "),n("code",{pre:!0},[t._v(".proto")]),t._v(" files:")]),n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",{pre:!0,attrs:{class:"language-shell"}},[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -L https://github.com/working-group-two/wgtwoapis/blob/master/image.bin?raw"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true -o wgtwo.bin ")])]),n("h2",{attrs:{id:"setup-grpcurl"}},[n("a",{attrs:{href:"#setup-grpcurl","aria-hidden":"true"}},[t._v("#")]),t._v("Setup gRPCurl")]),n("p",[t._v("We use "),n("a",{attrs:{href:"https://github.com/fullstorydev/grpcurl",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("gRPCurl")]),t._v(" to invoke the gRPC APIs in this guide.")]),n("p",[t._v("If you don't have gRPCurl installed, you may run it through Docker:")]),n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",{pre:!0,attrs:{class:"language-shell"}},[n("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("grpcurl")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  docker run -v "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("/wgtwo.bin:/wgtwo.bin fullstorydev/grpcurl "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$@")]),t._v('"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])])]),n("h2",{attrs:{id:"sandbox-environment"}},[n("a",{attrs:{href:"#sandbox-environment","aria-hidden":"true"}},[t._v("#")]),t._v("Sandbox environment")]),n("p",[t._v("We do run a sandbox environment hosted at "),n("code",{pre:!0},[t._v("apisandbox.dub.prod.wgtwo.com")]),t._v(".")]),n("p",[t._v("This is a mock implementation of our gRPC APIs, and does not require any authentication.")]),n("h3",{attrs:{id:"setup-event-streaming"}},[n("a",{attrs:{href:"#setup-event-streaming","aria-hidden":"true"}},[t._v("#")]),t._v("Setup event streaming")]),n("blockquote",[n("p",[n("strong",[t._v("Note:")]),t._v(" This stream will timeout. We expect you to automatically reconnect when that happens.")])]),n("p",[t._v("This will send you all the available events of type "),n("code",{pre:!0},[t._v("SMS_EVENT")]),t._v(":")]),n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",{pre:!0,attrs:{class:"language-shell"}},[t._v("grpcurl -protoset wgtwo.bin "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{ "type": ["SMS_EVENT"] }\'')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  apisandbox.dub.prod.wgtwo.com:443 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  wgtwo.events.v0.EventsService.Subscribe")])]),n("h3",{attrs:{id:"send-sms"}},[n("a",{attrs:{href:"#send-sms","aria-hidden":"true"}},[t._v("#")]),t._v("Send SMS")]),n("p",[t._v("This will send you events of type "),n("code",{pre:!0},[t._v("SMS_EVENT")]),t._v(":")]),n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",{pre:!0,attrs:{class:"language-shell"}},[t._v("grpcurl -protoset wgtwo.bin "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{\n        "content": "This is a test message",\n        "from_subscriber": { "e164": "+4799990000" },\n        "to_e164": { "e164": "+46724450000" }\n      }\'')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  apisandbox.dub.prod.wgtwo.com:443 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  wgtwo.sms.v0.SmsService/SendTextFromSubscriber")])]),n("h3",{attrs:{id:"explore-the-api"}},[n("a",{attrs:{href:"#explore-the-api","aria-hidden":"true"}},[t._v("#")]),t._v("Explore the API")]),n("p",[t._v("For exploring the API, we do recommend "),n("a",{attrs:{href:"https://github.com/fullstorydev/grpcui",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("gRPC UI")]),t._v(".")]),n("p",[t._v("If you don't have "),n("a",{attrs:{href:"https://github.com/fullstorydev/grpcui",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("gRPC UI")]),t._v(" installed, you may run it through Docker:")]),n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",{pre:!0,attrs:{class:"language-shell"}},[t._v("docker run -v "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("/wgtwo.bin:/wgtwo.bin -p "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v(":8080 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  fullstorydev/grpcui -protoset wgtwo.bin apisandbox.dub.prod.wgtwo.com:443")])]),n("h2",{attrs:{id:"production-environment"}},[n("a",{attrs:{href:"#production-environment","aria-hidden":"true"}},[t._v("#")]),t._v("Production environment")]),n("p",[t._v("Our production environment is hosted at "),n("code",{pre:!0},[t._v("apisandbox.dub.prod.wgtwo.com")]),t._v(".")]),n("p",[t._v("This part of the guide will show you how to create a OAuth 2.0 token and use that to connected to our event stream.")]),n("h3",{attrs:{id:"create-oauth-20-client"}},[n("a",{attrs:{href:"#create-oauth-20-client","aria-hidden":"true"}},[t._v("#")]),t._v("Create OAuth 2.0 client")]),n("p",[t._v("Before you start, head over to "),n("a",{attrs:{href:"/oauth-2-0/create-o-auth-2-0-client/"}},[t._v("Create OAuth 2.0 client")]),t._v(".")]),n("p",[t._v("Create a client in "),n("a",{attrs:{href:"https://developer.wgtwo.com",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("https://developer.wgtwo.com")]),t._v(", and enable the scope "),n("code",{pre:!0},[t._v("events.sms.subscribe")]),t._v(".")]),n("ClientCredentials"),n("h3",{attrs:{id:"get-access-token-using-the-client-credentials-flow"}},[n("a",{attrs:{href:"#get-access-token-using-the-client-credentials-flow","aria-hidden":"true"}},[t._v("#")]),t._v("Get access token (using the Client Credentials Flow)")]),n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",{pre:!0,attrs:{class:"language-shell"}},[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -s -u "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${CLIENT_ID}")]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${CLIENT_SECRET}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --request POST "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --url "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://id.wgtwo.com/oauth2/token'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --header "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type: application/x-www-form-urlencoded'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --data "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("grant_type")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"client_credentials"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --data "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("scope")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"events.sms.subscribe"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" jq "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")])])]),n("DemoConfigurer"),n("h3",{attrs:{id:"setup-stream-listening-for-events"}},[n("a",{attrs:{href:"#setup-stream-listening-for-events","aria-hidden":"true"}},[t._v("#")]),t._v("Setup stream listening for events")]),n("blockquote",[n("p",[n("strong",[t._v("Note:")]),t._v(" This stream will timeout. We expect you to automatically reconnect when that happens.")]),n("p",[t._v("For details, see: "),n("a",{attrs:{href:"/events/configuration-and-types/#recommended-production-configuration"}},[t._v("Configuration and types 〉 Recommended production configuration")]),t._v(".")])]),n("p",[t._v("This will send you all the available events of type "),n("code",{pre:!0},[t._v("SMS_EVENT")]),t._v(". As nobody has consented to share their events to you,\nthe stream may be a bit silent...")]),n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",{pre:!0,attrs:{class:"language-shell"}},[t._v("grpcurl -H "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Authorization: Bearer '),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ACCESS_TOKEN}")]),t._v('"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -protoset wgtwo.bin "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{ "type": ["SMS_EVENT"], "start_at_oldest_possible": {} }\'')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  api.wgtwo.com:443 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  wgtwo.events.v0.EventsService.Subscribe")])]),n("h4",{attrs:{id:"example-code-for-go"}},[n("a",{attrs:{href:"#example-code-for-go","aria-hidden":"true"}},[t._v("#")]),t._v("Example code for Go")]),n("h5",{attrs:{id:"download-and-run-code-sample"}},[n("a",{attrs:{href:"#download-and-run-code-sample","aria-hidden":"true"}},[t._v("#")]),t._v("Download and run code sample")]),n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",{pre:!0,attrs:{class:"language-shell"}},[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -sL https://github.com/working-group-two/docs.wgtwo.com/raw/master/examples/go/events/main.go -o main.go\ngo mod init example\ngo mod tidy\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("CLIENT_ID")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${CLIENT_ID}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("CLIENT_SECRET")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${CLIENT_SECRET}")]),t._v(" go run main.go")])]),n("h5",{attrs:{id:"code"}},[n("a",{attrs:{href:"#code","aria-hidden":"true"}},[t._v("#")]),t._v("Code")]),n("pre",{pre:!0,attrs:{class:"language-golang"}},[n("code",{pre:!0,attrs:{class:"language-golang"}},[t._v('package main\n\nimport (\n\t"context"\n\t"fmt"\n\t"github.com/golang/protobuf/jsonpb"\n\t"github.com/google/uuid"\n\twgtwoEvents "github.com/working-group-two/wgtwoapis/wgtwo/events/v0"\n\t"golang.org/x/oauth2/clientcredentials"\n\t"google.golang.org/grpc"\n\t"google.golang.org/grpc/credentials"\n\t"google.golang.org/grpc/credentials/oauth"\n\t"google.golang.org/grpc/status"\n\t"google.golang.org/protobuf/types/known/durationpb"\n\t"io"\n\t"os"\n\t"time"\n)\n\nvar marshaler = jsonpb.Marshaler{}\n\nfunc main() {\n\tclientCredentialsConfig := &clientcredentials.Config{\n\t\tClientID:     os.Getenv("CLIENT_ID"),\n\t\tClientSecret: os.Getenv("CLIENT_SECRET"),\n\t\tScopes: []string{\n\t\t\t"events.sms.subscribe",\n\t\t},\n\t\tTokenURL: "https://id.wgtwo.com/oauth2/token",\n\t}\n\n\tconn, err := grpc.Dial(\n\t\t"api.wgtwo.com:443",\n\t\tgrpc.WithTransportCredentials(credentials.NewClientTLSFromCert(nil, "")),\n\t\tgrpc.WithPerRPCCredentials(\n\t\t\toauth.TokenSource{\n\t\t\t\tTokenSource: clientCredentialsConfig.TokenSource(context.Background()),\n\t\t\t},\n\t\t),\n\t)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tdefer conn.Close()\n\n\tclient := wgtwoEvents.NewEventsServiceClient(conn)\n\trequest := &wgtwoEvents.SubscribeEventsRequest{\n\t\tType:          []wgtwoEvents.EventType{wgtwoEvents.EventType_SMS_EVENT},\n\t\tStartPosition: &wgtwoEvents.SubscribeEventsRequest_StartAtOldestPossible{},\n\t\tClientId:      uuid.New().String(),\n\t\tQueueName:     "test",\n\t\tDurableName:   "test",\n\t\tMaxInFlight:   10,\n\t\tManualAck: &wgtwoEvents.ManualAckConfig{\n\t\t\tEnable:  true,\n\t\t\tTimeout: durationpb.New(10 * time.Second),\n\t\t},\n\t}\n\n\tstream, err := client.Subscribe(context.TODO(), request)\n\n\tif err != nil || stream == nil {\n\t\tfmt.Println("Could not create stream. Invalid credentials perhaps?")\n\t\treturn\n\t}\n\n\tfor {\n\t\tfmt.Println("Starting stream...")\n\t\tresponse, err := stream.Recv()\n\t\tif err == io.EOF {\n\t\t\tbreak\n\t\t} else if err != nil {\n\t\t\terrStatus, _ := status.FromError(err)\n\t\t\tfmt.Printf("Could not get response: %s\\n", errStatus.Code())\n\t\t\tbreak\n\t\t}\n\t\tdisplayEvent(response)\n\t\tack(client, response.Event)\n\n\t}\n}\n\nfunc displayEvent(response *wgtwoEvents.SubscribeEventsResponse) {\n\tjson, err := marshaler.MarshalToString(response)\n\tif err != nil {\n\t\tfmt.Println("Could not parse response")\n\t} else {\n\t\tfmt.Println(json)\n\t}\n}\n\nfunc ack(client wgtwoEvents.EventsServiceClient, event *wgtwoEvents.Event) {\n\tackCtx, cancel := context.WithTimeout(context.Background(), time.Second*10)\n\tdefer cancel()\n\t_, err := client.Ack(ackCtx, &wgtwoEvents.AckRequest{Inbox: event.Metadata.AckInbox, Sequence: event.Metadata.Sequence})\n\tif err != nil {\n\t\tfmt.Println("Could not ack message...")\n\t}\n}')])]),n("h2",{attrs:{id:"whats-next"}},[n("a",{attrs:{href:"#whats-next","aria-hidden":"true"}},[t._v("#")]),t._v("What's next?")]),n("h3",{attrs:{id:"i-am-building-a-subscriber-product"}},[n("a",{attrs:{href:"#i-am-building-a-subscriber-product","aria-hidden":"true"}},[t._v("#")]),t._v("I am building a subscriber product")]),n("p",[t._v("All APIs, except the event API, will require a access token obtained via the Authorization Code Grant.")]),n("p",[t._v("By implementing this flow, your users will authenticate at our platform and grant the consents your application\nrequires. Once this flow is up, you can start using the API.")]),n("p",[t._v("There is a special event named "),n("code",{pre:!0},[t._v("CONSENT_REVOKE_EVENT")]),t._v(" that we do recommend you to listen for, as this will fire if the\nproduct is removed by the user through e.g. customer support.")]),n("p",[t._v("When you are done with your testing, you may submit your product so that it can be listed at our marketplace.")]),n("h2",{attrs:{id:"i-am-building-an-operator-product"}},[n("a",{attrs:{href:"#i-am-building-an-operator-product","aria-hidden":"true"}},[t._v("#")]),t._v("I am building an operator product")]),n("p",[t._v("You cannot add any test subscriptions yourself. By contacting us, we may add real subscriptions to be included for your\nproduct so that you can do real life testing.")]),n("p",[t._v("When you are done with your testing, you may submit your product so that it can be listed at our marketplace.")])],1)}),[],!1,null,null,null);"function"==typeof p&&p(d),"function"==typeof v&&v(d);e.default=d.exports},UQSp:function(t,e,n){"use strict";e.a={name:"VueRemarkRoot",render:function(t){return t("div",null,this.$slots.default)}}}}]);