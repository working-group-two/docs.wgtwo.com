(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{AWIW:function(e,t){e.exports={type:"image",mimeType:"image/svg+xml",src:"/assets/static/number-lookup-sequence.f86bfa7.c12b74c059c8d166618749f8d2acae59.svg",size:{width:865,height:647},sizes:"(max-width: 865px) 100vw, 865px",srcset:["/assets/static/number-lookup-sequence.82a2fbd.c12b74c059c8d166618749f8d2acae59.svg 480w","/assets/static/number-lookup-sequence.f86bfa7.c12b74c059c8d166618749f8d2acae59.svg 865w"],dataUri:"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 865 647' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-646a1681a7624e00710d04140c8dc74e'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-646a1681a7624e00710d04140c8dc74e)' width='865' height='647' xlink:href='data:image/svg%2bxml%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAwCAYAAAChS3wfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAJsElEQVRo3t1aa0wVSRbu5j4AeV10gBEGZ9AlKuOwyjDMLMQfsIy7rhsSZzabnf1FNhGiJuoSs0aN0V0fgwbfbxScVZlgNkYJuqgkKKK8QR4iTwFBzCrgExG4yN3zlVU3LXqx74WIdyo5qeru%2bqq7Tp1T55zqI0lUsrKyUEnnz583XL9%2b/bcFBQVRIGpH5eXlRV27do3V%2bfn5uB9ZWFgYffXq1bDZs2fLwJ07d47VFy5cmESYaPQRYwAL4liB/5bwXwFjMpmkjRs3SsOKzOsfiP5B5CBZX5YR/U1Vz4qKCg3qsrKyPzx69MjU2dnJ6OHDh6YnT56YHj9%2bzOru7m7T/fv3TT09PabW1taWVatWuQJXWlqqRV1ZWfmn58%2bfmx48eGAeA1hQV1cXuwa%2bt7cX%2bDqCMNzevXvfNnkXoufgEVEIv/cuRghsAMeBvIY9e7NUVVUxBpSXl8/HJOlDB4lelpSUDNFqDRUVFQ3l5OQM3blzZ4gmMghmtLe3N65du9aV47R8nO%2bfPXsG/AAxYQhUXV09RKs%2b1NzcPERjDxEDBtGH8DcJogNu//79lj4tnuhHIr2Vq4/Jrif6u6reCgb8HqtH1E8famxoaDCSdBhpEkZigrGtrc2IZ5AMatevWbPGlUuOYMB3kCDq0wc81cZbt24Zc3NzjcQ8IzHGSPf7IRGErxISsG/fPmlci2DAjRs3YgYHB00vXrxgNDAwYMK10Wg0vXz50tTf32%2bCiKPQCv6PJMCNM46tJDHqL3iGPmIMYDEGsLhW4O8ICUhKSnrte1xdXV/Ju4ODlkhnzVx0ulfdZVl2Eli9/h0CRCLKdIs2q1l1dXWnGhsbTxKlkQSk1dfX/0yUTsSu8aypqek/NTU1SYsWLdJxHMOTunxJ%2bNP0/ATwIODpXrq4pjEE/kehlwsWLLD0aR5En9gg/ii/IpqsGkU6apP0iA2MRNom/LRp05SXWuVmlZCQIMfHxzPmLl68WNV46enprM7IyJDJurCxUlNTRwZ1dHSwmnZmmCUHBclk1nQ02ASYK1ID8zO0d%2b7cyXAtLS3mcYbjMzMz9VQzGTx58iRTNR8fH19nZ%2bdQan5B9BuiML5i4coN78iRI9qUlBR2TbUqBhw6dIjVhw8f1iUnJ%2buV9ywWsuOCaxLZZ4kmLZ0%2bfVoMqDl48KAj2idOnIC4s%2bdXrlwx44HjfoSUnZ0t3b17V5o7d67E7bxM/gJEkSn2rFmzJEdHRw10lC4FeXKz5yh8A5QDBw5oifS8rYoBoh9ZFp212LcORJM3M4Bqm8Tc399/JhZebX%2byLuLdWiK9Ne8W/ajWCex4MQAbmJ%2bHh8cnkZGRbIVp1adQ7fwu4LFjx8aUATYt3BgwYCLRTCcnp88nT54M/Q4kCiYyWPFuu2aAuQidtuHd48eA2NhYVsPWx8XFYYNycHFx0ajFe3t7s3rz5s2a4OBgbIKamJgYVdjjx4%2bPPwNGWwQDUSZNmgTzNkEtdt26dePPADJVzIkgHZ5BNvuvcNiIvlNEVyOWtLQ0VpOvoCEVYJKzcOFCVe%2bmwOuDkAAtr/%2bpCC1BX6oJTUWAAz8iMTHRSelvKMoMok8VGyScos8Ukxk/BlBAwiTAzc3N393dPZKa3/APtnoTpbaThQ9x5aoBy%2bAObVGqCrmy2l27drENePr06fa1BwyzIk62fAisR21trdYazJgxYMmSJa/OlZYt0y5fvhyrIk%2bcONHhPTBAw71Gdz8/Py9yqeFQuZITZeDPRix9fX3Cm9RTPDB%2bnuAoGIAQezZUjjbir8mThNp9TvQ1V5MRS0hIiLmdlJSkLhj6wBigVAGHixcv6mzQQBeDwTAHeFxs377dvhgwdepUsYLaPXv2sFUMCgqy5vP15H5/evv2bbZ/7N69%2b70wQB4rBpDnKQ5btBTWMgbEx8erwoaFhZnbtPKjV4Hk5GQNmSI2geLi4vciAaOJBerq6li9YcMGPU189Jvgli1bNNXV1UwPw8PD3xrxcecoRBnpjRcDxjwaxIlOVFSUJz%2b5eUPX%2bKRhqj5W9lm6dKkYx74ZgEIbSjB3Wa0udi8BpEtakgKlN2ZQrDoI/wY%2b4rUrf0aRs4vMJQE7OWMA1fbHgKNHj2q2bdumFH/E9qHcMZkjvfoPh63317wGfaH8oZGVlcU%2b5NSpU/bHAKUZjIiIsHocCqVDoqOjsYdIvr6%2bsl0ygNqOShNjTfHy8vJev369s43v/rAYYMOpcDCF0gEUymIDDaKAZib39X/5h6J8D/iYIkjf4OBgX%2bwdxABvNRHdL%2b5UeBTvtl8GBAYGmh0pHx8fhLeq9wHhzyMWsFsGrFixwnyq4%2b/vP0OyPssDUZw2MTHRkTtjsl0xAD9SUfBfAFKA9rx589RAZZ1Oxxyvmpoa84my2lJaWireOzbBkK0MEHk/iCbpY5j4X7p0SVUsz52scL1eH%2bHh4RHET4wj1JwIiYANkifC4XGRgFFEgzJZEPQ3BAQEeIaGhsKJmkAWxF2NBRHHalOmTPHNyclhkkSerDqxKSoqkltaWrTt7e2a1tZWbW9vr%2bby5cuOZ8%2bedcHxEk5Y2traNPRc29jYqElISBA4VpeVlcnNzc1mfE9PjyY3N9ciXqHrlo7EZGtVQBy3k%2bR8JY7EVP2bLCkpsclkkZfH6vLyclkao%2bLp6cnGysjI0MTGxjL1MRgMqsYnv0MWk960aRNTAZKGkbEFBQWsQ15eXlBtbe1xWp3UhoaG1KamJtQ/Ef2bt48RpSBR6ubNm1vi4uJ0HOfAx5lD%2bJ/peQrwoPr6%2bp%2bIxJgCn0b4f4ljtB07dlj6NERPlfys4Y1jtxGO5aAuEMv/qrI%2blZWVIk%2bQpcn19fUxevr0KcvqBCE7FPfQRiFRfrB69Wo3LvqMEVVVVT/gGfqIMUBIj8M9pMop8O3CLbaQJ4h9AMlHkF9xIqo2U9SP4x4pTqlUZYqaEyWJBvLz843Z2dlG2geMZ86cMZIUGLu6ukZMlEQSZGdnpzlRsri42JiZmcmSLru7u9UmSoqP/Yz/I7Cl4F9CoCrJUSRKzuc5vUh1xQQG7927x6ijo2MQ12AMJkAbWcPwVNnq6urvkUYLBqAvUm6BJcYNIkUW18BDsghfLY2cKitbOnFWY0mswtLENdwa/BEiig8EIacXBPEHoY3JI/uTrMW9lStXuvINlDGgoqLiz1AhMEGMARyyQ4HFNfDIOkWytZCAEU6KnCUVKTUWio9qrPgfT%2bLuSSL7OxLpecSM14gmaW7T8/mFhYXhMTExMndwZD7OR4SfPxxP91675vhvxG69detWi394iLxtZAA2Ts93dfo/5/sDwXsUSvgAAAAASUVORK5CYII=' /%3e%3c/svg%3e"}},AmBI:function(e,t,r){"use strict";r.r(t);var o=r("7uw+"),a=r("UQSp"),n=r("Kw5r");function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.a.config.optionMergeStrategies;var i={VueRemarkRoot:a.a},l=function(e){var t=e.options.components=e.options.components||{},r=e.options.computed=e.options.computed||{};Object.keys(i).forEach((function(e){"object"===s(i[e])&&"function"==typeof i[e].render||"function"==typeof i[e]&&"function"==typeof i[e].options.render?t[e]=i[e]:r[e]=function(){return i[e]}}))},c=n.a.config.optionMergeStrategies,p="__vueRemarkFrontMatter",d={excerpt:null,title:"Technical guide",topic:"number lookup",type:"how-to",roles:["THIRD_PARTY_DEVELOPER"],sourceExamples:["examples/grpcurl/thirdpartydev/number-lookup/provider.sh","examples/kotlin/thirdpartydev/number-lookup/src/main/kotlin/com/wgtwo/examples/thirdpartydev/provider/Provider.kt"]};var u=function(e){e.options[p]&&(e.options[p]=d),n.a.util.defineReactive(e.options,p,d),e.options.computed=c.computed({$frontmatter:function(){return e.options[p]}},e.options.computed)},h=Object(o.a)({},(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("VueRemarkRoot",[o("h1",{attrs:{id:"number-lookup-api---technical-guide"}},[o("a",{attrs:{href:"#number-lookup-api---technical-guide","aria-hidden":"true"}},[e._v("#")]),e._v("Number Lookup API - Technical Guide")]),o("blockquote",[o("p",[o("strong",[e._v("This guide will show you how to set up a Number Lookup Provider.")])]),o("p",[e._v("You should have an understanding of how this works before continuing,\nsee "),o("a",{attrs:{href:"number-lookup/setup-number-lookup-overview/"}},[e._v("Overview")]),e._v(".")])]),o("h2",{attrs:{id:"prerequisites"}},[o("a",{attrs:{href:"#prerequisites","aria-hidden":"true"}},[e._v("#")]),e._v("Prerequisites")]),o("p",[e._v("This guide assumes you are able to create a OAuth 2.0 client and get an access token.")]),o("p",[e._v("See "),o("a",{attrs:{href:"https://docs.wgtwo.com/guide/oauth2/get-client-access-token.html",target:"_blank",rel:"nofollow noopener noreferrer"}},[e._v("Get client access token")]),e._v(" for how to get the\naccess token.")]),o("blockquote",[o("p",[o("strong",[e._v("Note:")]),o("br"),e._v("\nFor testing using our sandbox endpoint, authentication headers may be skipped.")])]),o("h3",{attrs:{id:"required-scope"}},[o("a",{attrs:{href:"#required-scope","aria-hidden":"true"}},[e._v("#")]),e._v("Required scope")]),o("p",[o("code",{pre:!0},[e._v("lookup.number:read")])]),o("h2",{attrs:{id:"how-to-use-the-api"}},[o("a",{attrs:{href:"#how-to-use-the-api","aria-hidden":"true"}},[e._v("#")]),e._v("How to use the API")]),o("p",[e._v("When you connect to this API, you will get a stream of number lookup requests for which you should respond with\ninformation about the number.")]),o("CodeSnippet",{attrs:{grpcurl:e.$sourceExamplesMap["examples/grpcurl/thirdpartydev/number-lookup/provider.sh"],kotlinDeps:["auth","lookup"],kotlin:e.$sourceExamplesMap["examples/kotlin/thirdpartydev/number-lookup/src/main/kotlin/com/wgtwo/examples/thirdpartydev/provider/Provider.kt"]}}),o("h2",{attrs:{id:"flow"}},[o("a",{attrs:{href:"#flow","aria-hidden":"true"}},[e._v("#")]),e._v("Flow")]),o("p",[e._v("The API is implemented as a bidirectional gRPC service, where the provider responds to requests from the server.")]),o("p",[e._v("The Number Provider sets up one or more connections to our API. This connection should use keep-alive, and has a max\nconnection age of one hour +/- a 10 % jitter. Once max connection age is reached, or any exception occurs, the\nconnection should be re-established.")]),o("blockquote",[o("p",[o("strong",[e._v("Note:")]),o("br"),e._v("\nAlthough the connection is set up from the provider to wg2, all requests are initiated from wg2.")])]),o("p",[o("g-image",{attrs:{src:r("pH4M")}})],1),o("p",[e._v("Using round-robin, wg2 will send number lookup requests\nover these connections for which the provider will respond with the display name.")]),o("p",[e._v("Responses will be cached for a period of time to avoid unnecessary requests and latency.")]),o("p",[o("g-image",{attrs:{src:r("AWIW")}})],1),o("h2",{attrs:{id:"request--response"}},[o("a",{attrs:{href:"#request--response","aria-hidden":"true"}},[e._v("#")]),e._v("Request / Response")]),o("p",[e._v("For matching the response to the original request, the provider must include the original request in the response.")]),o("p",[e._v("The returned display name may be empty if the provider does not have a display name for the number, and\nmay be cached for the duration specified.")]),o("h3",{attrs:{id:"request"}},[o("a",{attrs:{href:"#request","aria-hidden":"true"}},[e._v("#")]),e._v("Request")]),o("pre",{pre:!0,attrs:{class:"language-prototext"}},[o("code",{pre:!0,attrs:{class:"language-prototext"}},[e._v('NumberLookupRequest {\n  id: "opaque string"\n  number {\n    e164: "+1234567890"\n  }\n}')])]),o("h3",{attrs:{id:"response"}},[o("a",{attrs:{href:"#response","aria-hidden":"true"}},[e._v("#")]),e._v("Response")]),o("pre",{pre:!0,attrs:{class:"language-prototext"}},[o("code",{pre:!0,attrs:{class:"language-prototext"}},[e._v('NumberLookupResponse {\n  number_lookup_request { } # Fields omitted for brevity\n\n  result {\n    name: "John Doe"\n  }\n}')])]),o("h3",{attrs:{id:"response-upstream-error"}},[o("a",{attrs:{href:"#response-upstream-error","aria-hidden":"true"}},[e._v("#")]),e._v("Response, upstream error")]),o("pre",{pre:!0,attrs:{class:"language-prototext"}},[o("code",{pre:!0,attrs:{class:"language-prototext"}},[e._v('NumberLookupResponse {\n  number_lookup_request { } # Fields omitted for brevity\n\n  error {\n    message: "Database unavailable"\n  }\n}')])]),o("h2",{attrs:{id:"limitations-for-display-name"}},[o("a",{attrs:{href:"#limitations-for-display-name","aria-hidden":"true"}},[e._v("#")]),e._v("Limitations for display name")]),o("p",[e._v("The display name returned must be max 60 characters, and may only contain the following:")]),o("ul",[o("li",[e._v("alphanumeric ("),o("code",{pre:!0},[e._v("a-z")]),e._v(", "),o("code",{pre:!0},[e._v("A-Z")]),e._v(", "),o("code",{pre:!0},[e._v("0-9")]),e._v(")")]),o("li",[o("code",{pre:!0}),e._v(" (space), "),o("code",{pre:!0},[e._v("-")]),e._v(", "),o("code",{pre:!0},[e._v("_")])]),o("li",[o("code",{pre:!0},[e._v(".")]),e._v(", "),o("code",{pre:!0},[e._v("!")]),e._v(", "),o("code",{pre:!0},[e._v("%")]),e._v(", "),o("code",{pre:!0},[e._v("*")]),e._v(", "),o("code",{pre:!0},[e._v("'")]),e._v(", "),o("code",{pre:!0},[e._v("+")]),e._v(", "),o("code",{pre:!0},[e._v("~")]),e._v(", "),o("code",{pre:!0},[e._v("`")])])]),o("p",[e._v("Characters not matching the above will be stripped.")]),o("h2",{attrs:{id:"error-handling"}},[o("a",{attrs:{href:"#error-handling","aria-hidden":"true"}},[e._v("#")]),e._v("Error handling")]),o("p",[e._v("If there are no healthy connections for the provider, the provider will be ignored.")]),o("p",[e._v("Should the provider fail to respond within the set deadline, it will be treated as if it returned an empty result.")]),o("p",[e._v("For upstream errors, the provider must return an error, accompanied by a descriptive, human-readable message.")]),o("h2",{attrs:{id:"cache"}},[o("a",{attrs:{href:"#cache","aria-hidden":"true"}},[e._v("#")]),e._v("Cache")]),o("p",[e._v("As part of the response, the provider can include a cache TTL.")]),o("p",[e._v("This is the time in seconds that the display name should be cached on the wg2 side.\nIf not set, a default cache TTL documented in the proto file will be used.")]),o("pre",{pre:!0,attrs:{class:"language-prototext"}},[o("code",{pre:!0,attrs:{class:"language-prototext"}},[e._v('NumberLookupResponse {\n  number_lookup_request { } # Fields omitted for brevity\n\n  result {\n    name: "John Doe"\n  }\n\n  # Optional, set to default if not set\n  cache_control {\n    max_age {\n      seconds: 3600  # 1 hour, google.protobuf.Duration\n    }\n  }\n}')])]),o("h2",{attrs:{id:"recommended-grpc-connection-settings"}},[o("a",{attrs:{href:"#recommended-grpc-connection-settings","aria-hidden":"true"}},[e._v("#")]),e._v("Recommended gRPC connection settings")]),o("table",[o("thead",[o("tr",[o("th",{attrs:{align:"left"}},[e._v("Setting")]),o("th",{attrs:{align:"left"}},[e._v("Value")]),o("th",[e._v("Description")])])]),o("tbody",[o("tr",[o("td",{attrs:{align:"left"}},[e._v("keep-alive period")]),o("td",{attrs:{align:"left"}},[e._v("1 minute")]),o("td",[e._v("Must be ≥ 1 minute and ≤ 5 minutes")])]),o("tr",[o("td",{attrs:{align:"left"}},[e._v("keep-alive timeout")]),o("td",{attrs:{align:"left"}},[e._v("10 seconds")]),o("td")]),o("tr",[o("td",{attrs:{align:"left"}},[e._v("permit keep-alive without calls")]),o("td",{attrs:{align:"left"}},[e._v("true")]),o("td")])])]),o("h3",{attrs:{id:"keep-alive"}},[o("a",{attrs:{href:"#keep-alive","aria-hidden":"true"}},[e._v("#")]),e._v("Keep-Alive")]),o("p",[e._v("The load balancer hosting api.wgtwo.com will silently drop connections if they have been idle for 350 seconds (5m 50s).")]),o("p",[e._v("To avoid this, the provider should send a keep-alive message every minute.")]),o("h2",{attrs:{id:"continue-reading"}},[o("a",{attrs:{href:"#continue-reading","aria-hidden":"true"}},[e._v("#")]),e._v("Continue reading")]),o("ul",[o("li",[o("a",{attrs:{href:"/number-lookup/api-reference/"}},[e._v("API reference")])])]),o("h2",{attrs:{id:"concepts"}},[o("a",{attrs:{href:"#concepts","aria-hidden":"true"}},[e._v("#")]),e._v("Concepts")]),o("ul",[o("li",[o("a",{attrs:{href:"https://grpc.io/docs/guides/concepts/",target:"_blank",rel:"nofollow noopener noreferrer"}},[e._v("gRPC concepts")])]),o("li",[o("a",{attrs:{href:"https://grpc.io/docs/languages/kotlin/basics/",target:"_blank",rel:"nofollow noopener noreferrer"}},[e._v("Kotlin gRPC tutorial")])]),o("li",[o("a",{attrs:{href:"https://grpc.io/docs/reference/java/generated-code/",target:"_blank",rel:"nofollow noopener noreferrer"}},[e._v("Java gRPC stubs")])])])],1)}),[],!1,null,null,null);"function"==typeof l&&l(h),"function"==typeof u&&u(h);t.default=h.exports},UQSp:function(e,t,r){"use strict";t.a={name:"VueRemarkRoot",render:function(e){return e("div",null,this.$slots.default)}}},pH4M:function(e,t){e.exports={type:"image",mimeType:"image/svg+xml",src:"/assets/static/number-lookup-flow.726e733.be2bb1c52bff4bf4ca6b4dad6ad746f4.svg",size:{width:492,height:214},sizes:"(max-width: 492px) 100vw, 492px",srcset:["/assets/static/number-lookup-flow.726e733.be2bb1c52bff4bf4ca6b4dad6ad746f4.svg 492w"],dataUri:"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 492 214' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-19e2d937fd954ef8eb4c9be5cfe344b9'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-19e2d937fd954ef8eb4c9be5cfe344b9)' width='492' height='214' xlink:href='data:image/svg%2bxml%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAcCAYAAADRJblSAAAACXBIWXMAAAsTAAALEwEAmpwYAAABIUlEQVRYw%2b2ZzQ7BQBCASx28ghNv4Swq3sDNyREJD8CBZ/EkEoLiIITEE4gDTn7aMo2ZpLeutduozCZf2jTdne4308usYbxHQpK/GQNgA9jAIoQ5sgLyOD%2bp8dt80SbGUIkZTOIaeEpQxvmmho3Tmk3gCGyBvSJ2wAGoUrApbugOOAI88P2ixgpI4bUnmRwRWhTMxgeOwCQPcPHe0lgBJKCDsa4YVwU3XLMeBwHdQHWqyjxVcIMFsAAWwAJYAAtgASyABbAAFsACWAALYAEs4Nc7Qo4iYtUR6mvsCbYp2CxQGl4IbkCUpbEpSlJr2MUdARNFjPEYoELBlpIGSxorINIxxMyegIsAZ/wnCxEcjHxzciV8spUBckD2A/z303HP/At9kW9/2aglUQAAAABJRU5ErkJggg==' /%3e%3c/svg%3e"}}}]);